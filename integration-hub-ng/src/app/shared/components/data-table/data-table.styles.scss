// Unified Data Table Styles
// This file contains all table styles used across the application
// Based on the Recent Activity table design from the Overview page

// Base table styles - applied to all app-data-table components (minimal styling is now default)
:host {
  .data-table-wrapper {
    width: 100%;
    position: relative;
    min-height: 200px; // Prevent layout collapse during loading
  }

  // Skeleton loading overlay
  .skeleton-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1;
  }

  .skeleton-table {
    width: 100%;
  }

  .skeleton-header {
    display: flex;
    gap: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    margin-bottom: 0.5rem;

    .skeleton-cell {
      flex: 1;
      height: 14px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 4px;
      max-width: 120px;
    }
  }

  .skeleton-body {
    display: flex;
    flex-direction: column;
  }

  .skeleton-row {
    display: flex;
    gap: 1rem;
    padding: 0.875rem 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);

    &:last-child {
      border-bottom: none;
    }

    .skeleton-cell {
      flex: 1;
      display: flex;
      align-items: center;
    }

    .skeleton-bar {
      height: 12px;
      background: linear-gradient(
        90deg,
        rgba(255, 255, 255, 0.06) 0%,
        rgba(255, 255, 255, 0.12) 50%,
        rgba(255, 255, 255, 0.06) 100%
      );
      background-size: 200% 100%;
      animation: skeleton-shimmer 1.5s ease-in-out infinite;
      border-radius: 4px;
      width: 70%;
    }

    // Vary cell widths based on column position for visual interest
    .skeleton-cell:nth-child(1) .skeleton-bar { width: 85%; }
    .skeleton-cell:nth-child(2) .skeleton-bar { width: 55%; }
    .skeleton-cell:nth-child(3) .skeleton-bar { width: 70%; }
    .skeleton-cell:nth-child(4) .skeleton-bar { width: 80%; }
    .skeleton-cell:nth-child(5) .skeleton-bar { width: 50%; }
    .skeleton-cell:nth-child(6) .skeleton-bar { width: 65%; }
  }

  // Stagger skeleton row animation for smoother feel
  @for $i from 1 through 10 {
    .skeleton-row:nth-child(#{$i}) .skeleton-bar {
      animation-delay: #{$i * 0.05}s;
    }
  }

  @keyframes skeleton-shimmer {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  // Table content wrapper
  .table-content {
    opacity: 0;
    transition: opacity 200ms ease-out;

    &.visible {
      opacity: 1;
    }
  }

  // Loading state adjustments
  .data-table-wrapper.is-loading {
    .table-content {
      visibility: hidden;
      position: absolute;
      pointer-events: none;
    }
  }

  // Reduced motion support
  @media (prefers-reduced-motion: reduce) {
    .skeleton-bar {
      animation: none;
      background: rgba(255, 255, 255, 0.08);
    }
    
    .table-content {
      transition: none;
    }
  }

  ::ng-deep ibm-table {
    .bx--data-table,
    .cds--data-table {
      background: transparent !important;
      border: none !important;
      width: 100% !important;
      overflow-x: visible !important;
    }

    // Hide checkbox column in all tables
    .bx--data-table thead th:first-child,
    .cds--data-table thead th:first-child,
    .bx--data-table tbody td:first-child,
    .cds--data-table tbody td:first-child,
    .cds--data-table .cds--table-column-checkbox {
      display: none !important;
    }

    // Remove zebra striping
    .cds--data-table--zebra tbody tr:not(.cds--parent-row):not(.cds--data-table--selected):nth-child(even) {
      background-color: transparent !important;
    }

    .cds--data-table--zebra tbody tr:not(.cds--parent-row):not(.cds--data-table--selected):nth-child(odd) {
      background-color: transparent !important;
    }

    // Table header styles - matching Recent Activity table
    .bx--data-table thead,
    .cds--data-table thead {
      background: transparent !important;

      th {
        background: transparent !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
        color: var(--linear-text-primary) !important;
        font-size: 0.8rem !important;
        font-weight: 700 !important;
        text-transform: uppercase !important;
        padding: 0 !important;
        text-align: left !important;
        white-space: normal !important;

        &.cds--table-column-checkbox,
        &.bx--table-column-checkbox {
          color: var(--linear-text-primary) !important;
          display: none !important;
        }

        // Fix button elements inside headers
        button {
          background: transparent !important;
          color: var(--linear-text-primary) !important;
          border: none !important;
          text-align: left !important;
          padding: 0 !important;

          &:hover {
            background: transparent !important;
            text-decoration: underline !important;
          }

          &:focus {
            background: rgba(255, 255, 255, 0.05) !important;
            outline: none !important;
          }
        }

        // Fix sort button specifically
        .cds--table-sort,
        .bx--table-sort {
          background: transparent !important;
          color: var(--linear-text-primary) !important;
          text-align: left !important;
        }
      }

      // Additional override for any Carbon header styles
      th.cds--table-header-label,
      th.bx--table-header-label {
        color: var(--linear-text-primary) !important;
        background: transparent !important;
        text-align: left !important;
      }
    }

    // Table body styles - matching Recent Activity table
    .bx--data-table tbody,
    .cds--data-table tbody {
      background: transparent !important;

      tr {
        transition: background 150ms ease !important;
        cursor: pointer !important;

        &:nth-child(odd) {
          background: transparent !important;
        }

        &:nth-child(even) {
          background: transparent !important;
        }

        &:hover {
          background: rgba(255, 255, 255, 0.02) !important;
        }

        &:last-child td {
          border-bottom: none !important;
        }
      }

      td {
        background: transparent !important;
        color: var(--linear-text-secondary) !important;
        font-size: 0.8rem !important;
        padding: 0 !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
        text-align: left !important;
        white-space: normal !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
      }
    }

    // Remove horizontal scrollbar and optimize layout
    .bx--data-table-container,
    .cds--data-table-container {
      overflow-x: visible !important;
      width: 100% !important;
      max-width: 100% !important;
    }
  }
}

// Minimal variant is now the default - keeping this for backward compatibility
// All tables now use minimal styling by default
:host(.minimal) {
  // Same as base styles - no changes needed
}

// Compact variant (for smaller tables) - if needed in future
:host(.compact) {
  ::ng-deep ibm-table {
    .bx--data-table thead th,
    .cds--data-table thead th {
      font-size: 0.75rem !important;
    }

    .bx--data-table tbody td,
    .cds--data-table tbody td {
      font-size: 0.75rem !important;
    }
  }
}

